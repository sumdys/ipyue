app.service("goodsModel",["baseModel","apiConfig","dateService",function(e,t,a){this.list=function(a,i,r){var n=e.structureApiUrl(t.goods.list);e.request(n,"GET",a,function(e,a,n){a==t.errorCode.success?i(e,e.count,e.page_num):r(a,n)})},this.detail=function(a,i,r){var n=e.structureApiUrl(t.goods.detail).replace(":id",a.goodsId);e.request(n,"GET",a,function(e,a,n){a==t.errorCode.success?i(e):r(a,n)})},this.handleInventoryListForCalendar=function(e,t,i,r,n){for(var o=[],d=0;d<e.length;d++){var s=e[d],c=s.time.year,l=s.time.month<10?"0"+s.time.month:s.time.month;if(c==i.year&&l==i.month)for(var y=0;y<s.inventory.length;y++){var p=0,u=t[y];u.displayDay=u.day;var m=s.inventory[y];m.i_inventory>0?u.displayPrice="￥"+m.i_price:(p=-1,u.displayPrice="无房"),u.inventory=m;var h=a.getCurrentDateWithFormat("yyyy-MM-dd");u.date==h?("show"==r?p=1:"select"==r&&n.start&&u.date==n.start&&(u.displayPrice="入住",p=1),u.displayDay="今天"):a.compareTime(u.date,h)?(p=-1,u.displayPrice=""):"select"==r&&(u.date==n.start?(u.displayPrice="入住",p=1):u.date==n.end?(u.displayPrice="离店",p=1):n.length>0&&a.compareTime(n.start,u.date)&&a.compareTime(u.date,n.end)&&(p=1)),u.showType=p,o.push(u)}}return o},this.handleSelectDatesResult=function(e,t,i){var r=angular.copy(e),n=!1,o=0;return angular.forEach(r,function(e,r){angular.forEach(e.week,function(e,r){angular.forEach(e,function(e,r){if(e.isShow){var d=0;e.displayDay=e.day;var s=e.inventory;s.i_inventory>0?e.displayPrice="￥"+s.i_price:e.displayPrice="无房",e.inventory=s;var c=a.getCurrentDateWithFormat("yyyy-MM-dd");e.date==c?(t.start&&e.date==t.start&&(e.displayPrice="入住",d=1,o=(1e3*o+1e3*s.i_price)/1e3),e.displayDay="今天"):a.compareTime(e.date,c)?(d=-1,e.displayPrice=""):e.date==t.start?(e.displayPrice="入住",d=1,o=(1e3*o+1e3*s.i_price)/1e3):e.date==t.end?(e.displayPrice="离店",d=1):t.length>0?a.compareTime(t.start,e.date)&&a.compareTime(e.date,t.end)&&(d=1,o=(1e3*o+1e3*s.i_price)/1e3):i?e.date==i?(t.end=i,t.length=a.dateDiff(t.start,t.end),e.displayPrice="离店",d=1):a.compareTime(t.start,e.date)&&a.compareTime(e.date,i)&&(0==e.inventory.i_inventory?n=!0:(d=1,o=(1e3*o+1e3*s.i_price)/1e3)):a.compareTime(t.start,e.date)&&1==a.dateDiff(t.start,e.date)&&0==e.inventory.i_inventory&&(t.end=e.date,t.length=1,e.displayPrice="离店",d=1,o=(1e3*o+1e3*s.i_price)/1e3),e.showType=d}})})}),n?(t.end="",t.length=0,t.totalFee=0,e):(t.totalFee=o,r)},this.goodClassification=function(a,i,r){var n=e.structureApiUrl(t.goods.categores);e.request(n,"GET",a,function(e,a,n){a==t.errorCode.success?i(e.data_list):r(a,n)})}}]);